webpackJsonp([7],{631:function(t,e,i){function s(t){i(719)}var r=i(12)(i(677),i(761),s,null,null);t.exports=r.exports},645:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},646:function(t,e,i){"use strict";var s=i(648),r=i.n(s),a=i(35),n=i(66),o=i(231),c=i(647),u=i(232),d={lastLyric:0,typeType:localStorage.getItem("audioPlayType")||a.a.getters.getAudioPlayType,lyric:{},maxProgressWidth:0,dragProgressTo:0,x:0,l:0,parseLrc:function(t){if(!t)return"";for(var e=t.split("\n"),i={},s=0;s<e.length;s++){var r=decodeURIComponent(e[s]),a=/\[\d*:\d*((\.|\:)\d*)*\]/g,n=r.match(a);if(n)for(var o=r.replace(a,""),c=0,u=n.length;c<u;c++){var d=n[c],l=Number(String(d.match(/\[\d*/i)).slice(1)),p=Number(String(d.match(/\:\d*/i)).slice(1)),g=60*l+p;i[g]=o}}return i},getMusicSheet:function(t){var e="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=playlist&id="+t;n.a.get(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){a.a.dispatch({type:"set_MusicSheetList",data:t.data.playlist.tracks}),a.a.dispatch({type:"set_MusicList",data:t.data.playlist.tracks})},function(t){console.log(t)})},getAlbum:function(t){var e="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=album&id="+t;n.a.get(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){a.a.dispatch({type:"set_MusicSheetList",data:t.data.songs}),a.a.dispatch({type:"set_MusicList",data:t.data.songs})},function(t){console.log(t)})},getMusicLrc:function(t,e){var i=this,s=a.a.getters.getAudioEle,r="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=lyric&id="+t.id;n.a.get(r).then(function(r){var n={};void 0===r.data.lrc?n={0:"纯音乐,请欣赏"}:(n=i.parseLrc(r.data.lrc.lyric),i.lyric=n),i.lastLyric=-1;var o={id:t.id,name:t.name,url:d.replaceUrl(t.url),singer:t.singer,duration:t.duration,picurl:t.picurl,index:t.musicndex,lyric:n,lrcContent:a.a.getters.getAudioLrcContent};a.a.commit({type:"setCurrentAudio",data:o}),"unupdate"!==t.type&&""===t.type&&a.a.dispatch({type:"set_MusicPlayList",data:t.list}),e.$nextTick(function(){try{a.a.getters.getAudioEle.load(),a.a.getters.getAudioEle.play()}catch(t){return}a.a.commit({type:"setAudiolrcIndex",data:0}),i.scrollAnimate(document.getElementsByClassName("lrc-wrapper")[0],0),a.a.commit("setAudioIsPlay",!s.paused)})},function(t){console.log(t)})},getMusicDurantionType:function(t){return(Math.floor(t/1e3/60)>=10?Math.floor(t/1e3/60):"0"+Math.floor(t/1e3/60))+":"+(Math.floor(t/1e3%60)>=10?Math.floor(t/1e3%60):"0"+Math.floor(t/1e3%60))},scrollLyric:function(t,e){if(""===this.lyric)return!1;if(t=parseInt(t),void 0===this.lyric||void 0===this.lyric[t])return!1;if(this.lastLyric===t)return!0;var i=0;a.a.commit({type:"setAudiolrcIndex",data:i});for(var s in this.lyric){if(s>t)break;i++}this.lastLyric=t,a.a.commit({type:"setAudiolrcIndex",data:i});try{this.scrollAnimate(e.$refs.lrcWrapper,i*document.getElementsByClassName("lrc-item")[0].offsetHeight)}catch(t){return}},clickIndex:function(t,e){var i=this,s=t.music_id?t.music_id:t.id,r="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=musicInfo&id="+s;n.a.get(r).then(function(r){if(null===r.data.data[0].url){e.$msg("音乐无法播放,请播放其他音频...");var n={index:a.a.getters.getCurrentAudio.index};return a.a.commit({type:"setCurrentAudio",data:n}),void i.playNextPrev(e,!0)}var o={id:s,name:t.name,url:d.replaceUrl(r.data.data[0].url),singer:t.singer,duration:t.duration,picurl:t.pic,musicndex:t.index,list:t.list,type:t.type};i.getMusicLrc(o,e)},function(t){console.log(t)})},searchMusic:function(t,e,i){var s="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=search&count=30&pages="+e+"&name="+t;n.a.get(s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){try{console.log(i.searchMusicList),t.data.result.songs.forEach(function(t,e,s){i.searchMusicList.push(t)}),a.a.dispatch({type:"set_MusicSearchList",data:i.searchMusicList}),a.a.dispatch({type:"set_MusicList",data:i.searchMusicList})}catch(t){return}},function(t){console.log(t)})},scrollAnimate:function(t,e){t.style.WebkitTransform="translate3d(-50%, -"+e+"px, 0)",t.style.transform="transform: translate3d(-50%, -"+e+"px, 0)"},collectMusic:function(t){var e=this;i.i(c.a)().then(function(s){var r={userid:s.id,music_id:t.id,music_name:t.name,singer_id:t.ar[0].id,singer_name:t.ar[0].name,album_id:t.al.id,album_name:t.al.name,music_dur:t.dt,music_picurl:t.al.picUrl};i.i(c.b)("http://www.daiwei.org/vue/server/user.php?inAjax=1&do=collectMusic",r).then(function(t){e.$msg(t.data.msg)},function(t){e.$msg(t)})},function(t){e.$msg(t.msg),e.$router.push({path:"/user/login"})})},getLocalMusic:function(){var t=this;i.i(c.a)().then(function(e){i.i(c.b)("http://www.daiwei.org/vue/server/user.php?inAjax=1&do=getCollectMusic",{userid:e.id}).then(function(t){a.a.commit({type:"setMusicCollectList",data:t.data})},function(e){t.$msg(e)})},function(e){t.$msg(e.msg),t.$router.push({path:"/user/login"})})},deleteMusic:function(t){var e=this;i.i(c.a)().then(function(s){i.i(c.b)("http://www.daiwei.org/vue/server/user.php?inAjax=1&do=delCollectMusic",{userid:s.id,music_id:t}).then(function(i){var s=a.a.getters.getMusicCollectList;s.forEach(function(e,i,r){if(t===e.music_id)return void s.splice(i,1)}),a.a.commit({type:"setMusicCollectList",data:s}),e.$msg(i.data.msg)},function(t){e.$msg(t)})},function(t){e.$msg(t.msg),e.$router.push({path:"/user/login"})})},playPause:function(){try{var t=a.a.getters.getAudioEle;if(!(t.src.indexOf(".mp3")>0))return;t.paused?t.play():t.pause(),a.a.commit("setAudioIsPlay",!t.paused)}catch(t){return}},playNextPrev:function(t,e){var i=this,s=a.a.getters.getCurrentAudio.index||0,r=a.a.getters.getMusicPlayList.length||0,o=a.a.getters.getMusicPlayList||[];if(3!==this.typeType?e?++s>r-1&&(s=0):--s<0&&(s=r-1):s=Math.floor(Math.random()*r),void 0!==o[s]){var c=o[s].music_id?o[s].music_id:o[s].id,u="http://www.daiwei.org/vue/server/music.php?inAjax=1&do=musicInfo&id="+c;n.a.get(u).then(function(r){if(null===r.data.data[0].url){var n={index:a.a.getters.getCurrentAudio.index?e?a.a.getters.getCurrentAudio.index+1:a.a.getters.getCurrentAudio.index-1:e?1:0};return a.a.commit({type:"setCurrentAudio",data:n}),void i.playNextPrev(t,e)}var u={id:c,name:o[s].name?o[s].name:o[s].music_name,url:d.replaceUrl(r.data.data[0].url),singer:o[s].ar?o[s].ar[0].name:o[s].singer_name,duration:d.getMusicDurantionType(o[s].dt?o[s].dt:o[s].music_dur),picurl:o[s].al?o[s].al.picUrl:o[s].music_picurl,musicndex:s,list:a.a.getters.getMusicList,type:"unupdate"};i.getMusicLrc(u,t)},function(t){console.log(t)})}},initAudioEvent:function(t){var e=this,i=a.a.getters.getAudioEle;i.onloadedmetadata=function(){},i.onended=function(){e.insetMusicListen(),e.playNextPrev(t,!0)},i.ontimeupdate=function(){if(!t.isDrag){var e=a.a.getters.getAudioEle,i=Math.floor(e.duration),s=Math.floor(e.currentTime);d.scrollLyric(s,t),a.a.dispatch("set_AudioCurrentTime",s),a.a.dispatch("set_AudioCurrentD",s/i*100)}},i.onprogress=function(){var e=Math.floor(i.duration);try{if(i.buffered.length>0){for(var s=0,r=0;r<i.buffered.length;r++)(s+=i.buffered.end(r)-i.buffered.start(r))>e&&(s=e,console.log("缓冲完成"));var a=Math.floor(s/e*100);t.bufferingP=a}}catch(t){return}}},dragMouseDown:function(t,e){var i=a.a.getters.getAudioEle;if(!(i.src.indexOf(".")<0)){var s=this;t.isDrag=!0;var r=e||window.event,n=r.clientX,o=r.target.offsetLeft;s.maxProgressWidth=document.getElementById("music_progressD").offsetWidth;var c=document.getElementById("music_progress");c.onmousemove=function(e){if(t.isDrag){var i=e||window.event,r=i.clientX;s.dragProgressTo=Math.min(s.maxProgressWidth,Math.max(0,o+(r-n))),s.updateDragProgress(t,s.maxProgressWidth,s.dragProgressTo)}},c.onmouseup=function(e){var r=i.duration;t.isDrag&&(t.isDrag=!1,i.currentTime=Math.floor(s.dragProgressTo/s.maxProgressWidth*r))},c.onmouseleave=function(e){var r=i.duration;t.isDrag&&(t.isDrag=!1,i.currentTime=Math.floor(s.dragProgressTo/s.maxProgressWidth*r))}}},dragTouchStart:function(t,e){if(!(a.a.getters.getAudioEle.src.indexOf(".")<0)){var i=this;t.isDrag=!0;var s=e||window.event;i.x=s.touches[0].clientX,i.l=s.target.offsetLeft,i.maxProgressWidth=document.getElementById("music_progressD").offsetWidth}},dragTouchMove:function(t,e){var i=this;if(t.isDrag){var s=e||window.event,r=s.touches[0].clientX;i.dragProgressTo=Math.min(i.maxProgressWidth,Math.max(0,i.l+(r-i.x))),i.updateDragProgress(t,i.maxProgressWidth,i.dragProgressTo)}},dragTouchEnd:function(t,e){var i=this,s=a.a.getters.getAudioEle,r=s.duration;t.isDrag&&(t.isDrag=!1,s.currentTime=Math.floor(i.dragProgressTo/i.maxProgressWidth*r))},updateDragProgress:function(t,e,i){var s=a.a.getters.getAudioEle,r=s.duration;d.scrollLyric(Math.floor(i/e*r),t),a.a.dispatch("set_AudioCurrentTime",Math.floor(i/e*r)),a.a.dispatch("set_AudioCurrentD",Math.floor(i/e*r)/r*100)},clickProgress:function(t){var e=a.a.getters.getAudioEle,i=e.duration,s=t||window.event,r=s.offsetX,n=document.getElementById("music_progressD").offsetWidth;e.currentTime=Math.floor(r/n*i)},replaceUrl:function(t){return t.indexOf("//m7c")<0?t.indexOf("//m8c")?t.replace("//m8c","//m8"):t:t.replace("//m7c","//m7")},insetMusicListen:function(){i.i(c.a)().then(function(t){var e=a.a.getters.getCurrentAudio.index,s=a.a.getters.getMusicPlayList,r={userid:t.id,username:t.username,music_id:s[e].music_id||s[e].id,music_name:s[e].music_name||s[e].name,singer_id:s[e].singer_id||s[e].ar[0].id,singer_name:s[e].singer_name||s[e].ar[0].name,album_id:s[e].album_id||s[e].al.id,album_name:s[e].album_name||s[e].al.name,music_dur:s[e].music_dur||s[e].dt,music_picurl:s[e].music_picurl||s[e].al.picUrl,listen_time:o.a.formatDate(new Date,"yyyy-MM-dd hh:mm:ss")};i.i(c.b)("http://www.daiwei.org/vue/server/user.php?inAjax=1&do=userMusicListen",r).then(function(t){console.log(r.music_name+"播放完成")},function(t){u.default.$msg(t)})},function(t){u.default.$msg(t.msg)})},setPlayType:function(t){this.typeType=r()(t),a.a.dispatch({type:"set_AudioPlayType",data:this.typeType}),localStorage.setItem("audioPlayType",this.typeType)}};e.a=d},647:function(t,e,i){"use strict";function s(t,e){return new n.a(function(i,s){o.a.post(t,e).then(function(t){i(t)},function(t){s(t)})})}function r(){var t=c.a.getters.getUserInfo;return new n.a(function(e,i){null===t?(u.a.push("/user/login"),i(d)):e(t)})}e.b=s,e.a=r;var a=i(101),n=i.n(a),o=i(66),c=i(35),u=i(150),d={code:0,msg:"用户未登录"}},648:function(t,e,i){t.exports={default:i(649),__esModule:!0}},649:function(t,e,i){i(652),t.exports=parseInt},650:function(t,e,i){var s=i(15).parseInt,r=i(651).trim,a=i(645),n=/^[-+]?0[xX]/;t.exports=8!==s(a+"08")||22!==s(a+"0x16")?function(t,e){var i=r(String(t),3);return s(i,e>>>0||(n.test(i)?16:10))}:s},651:function(t,e,i){var s=i(60),r=i(102),a=i(67),n=i(645),o="["+n+"]",c="​",u=RegExp("^"+o+o+"*"),d=RegExp(o+o+"*$"),l=function(t,e,i){var r={},o=a(function(){return!!n[t]()||c[t]()!=c}),u=r[t]=o?e(p):n[t];i&&(r[i]=u),s(s.P+s.F*o,"String",r)},p=l.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(d,"")),t};t.exports=l},652:function(t,e,i){var s=i(60),r=i(650);s(s.S+s.F*(Number.parseInt!=r),"Number",{parseInt:r})},677:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(35),r=i(646);e.default={data:function(){return{currentMusic:{},params:this.$route.params,currentMusicLrcIndex:0,top_list_all:{0:["云音乐新歌榜","/discover/toplist?id=3779629"],1:["云音乐热歌榜","/discover/toplist?id=3778678"],2:["网易原创歌曲榜","/discover/toplist?id=2884035"],3:["云音乐飙升榜","/discover/toplist?id=19723756"],4:["云音乐电音榜","/discover/toplist?id=10520166"],5:["UK排行榜周榜","/discover/toplist?id=180106"],6:["美国Billboard周榜","/discover/toplist?id=60198"],7:["KTV嗨榜","/discover/toplist?id=21845217"],8:["iTunes榜","/discover/toplist?id=11641012"],9:["Hit FM Top榜","/discover/toplist?id=120001"],10:["日本Oricon周榜","/discover/toplist?id=60131"],11:["韩国Melon排行榜周榜","/discover/toplist?id=3733003"],12:["韩国Mnet排行榜周榜","/discover/toplist?id=60255"],13:["韩国Melon原声周榜","/discover/toplist?id=46772709"],14:["中国TOP排行榜(港台榜)","/discover/toplist?id=112504"],15:["中国TOP排行榜(内地榜)","/discover/toplist?id=64016"],16:["香港电台中文歌曲龙虎榜","/discover/toplist?id=10169002"],17:["华语金曲榜","/discover/toplist?id=4395559"],18:["中国嘻哈榜","/discover/toplist?id=1899724"],19:["法国 NRJ EuroHot 30周榜","/discover/toplist?id=27135204"],20:["台湾Hito排行榜","/discover/toplist?id=112463"],21:["Beatport全球电子舞曲榜","/discover/toplist?id=3812895"]}}},props:{lrccontent:{}},methods:{searchMusic:function(t){this.$router.push({name:"searchlist",params:{w:t.target.innerHTML}})},getAlbum:function(t){this.$router.push({name:"albumlist",params:{id:t}})},clickPlayList:function(t,e,i,a){var n={id:t,pic:e,duration:i,index:a,list:s.a.getters.getMusicList};r.a.clickIndex(n,this)},getMusicDurationType:function(t){return r.a.getMusicDurantionType(t,this)},initMusic:function(){r.a.getAlbum(this.params.id)},AudiEle:function(){return s.a.getters.getAudioEle},collectMusic:function(t){var e=s.a.getters.getMusicList[t];r.a.collectMusic.call(this,e)}},computed:{musicList:function(){return s.a.getters.getMusicList},getCurrentMusic:function(){return s.a.getters.getCurrentAudio},getMusicLrcLists:function(){return s.a.getters.getCurrentAudio.lyric},getCurrentMusicLrcIndex:function(){return this.currentMusicLrcIndex}},watch:{$route:function(t,e){this.params=this.$route.params}},mounted:function(){var t=this;this.$nextTick(function(){t.initMusic()})}}},719:function(t,e){},761:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music_album"},[i("div",{staticClass:"list_content_info"},[t._m(0),t._v(" "),i("div",{staticClass:"music_list_content"},t._l(t.musicList,function(e,s){return t.musicList?i("div",{key:e.id,staticClass:"music_list border-1px",attrs:{"data-musicid":e.id,"data-pic":e.al.picUrl},on:{click:function(i){t.clickPlayList(e.id,e.al.picUrl,t.getMusicDurationType(e.dt),s)}}},[i("span",{staticClass:"music_index"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.getCurrentMusic.id!==e.id,expression:"getCurrentMusic.id !== list.id"}]},[t._v(t._s(s+1))]),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.getCurrentMusic.id===e.id,expression:"getCurrentMusic.id === list.id"}],attrs:{src:"http://www.daiwei.org/vue/bg/wave.gif",alt:"未曾遗忘的青春"}})]),t._v(" "),i("div",{staticClass:"music_name"},[i("span",{staticClass:"span_name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"hover_menu"},[i("i",{staticClass:"icon-add",on:{click:function(e){e.stopPropagation(),t.collectMusic(s)}}})])]),t._v(" "),e.ar?i("span",{staticClass:"music_singer"},[i("span",{on:{click:function(e){e.stopPropagation(),t.searchMusic(e)}}},[t._v(t._s(e.ar[0].name))])]):t._e(),t._v(" "),e.al?i("span",{staticClass:"music_zhuanji"},[i("span",{on:{click:function(i){i.stopPropagation(),t.getAlbum(e.al.id)}}},[t._v(t._s(e.al.name))])]):t._e(),t._v(" "),i("span",{staticClass:"music_duration"},[t._v(t._s(t.getMusicDurationType(e.dt)))])]):t._e()}))])])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music_list_title border-1px"},[i("span",{staticClass:"music_index"}),t._v(" "),i("span",{staticClass:"music_name"},[t._v("歌曲")]),t._v(" "),i("span",{staticClass:"music_singer"},[t._v("歌手")]),t._v(" "),i("span",{staticClass:"music_zhuanji"},[t._v("专辑")]),t._v(" "),i("span",{staticClass:"music_duration"},[t._v("时长")])])}]}}});